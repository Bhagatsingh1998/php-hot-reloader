<?php
// CONFIG
$ROOT = "your_root_folder";
$MODE = "mtime";

$watch = [
  "folder_example_1",
  "folder_example_2",
  "folder_example_3"
];
// END CONFIG
?>
<?php
defined('WATCH_ROOT') or define( 'WATCH_ROOT', $ROOT ); function hashDirectory($directory, $mode){ if (! is_dir($directory)) return false; $files = array(); $dir = dir($directory); while (false !== ($file = $dir->read())){ if ($file != '.' and $file != '..'){ if (is_dir($directory . DIRECTORY_SEPARATOR . $file)){ $files[] = hashDirectory($directory . DIRECTORY_SEPARATOR . $file, $mode); } else{ $curr_file = $directory . DIRECTORY_SEPARATOR . $file; $files[] = ($mode == "mtime" ? stat($curr_file)['mtime'] : md5_file($curr_file)); } } } $dir->close(); return md5(implode('', $files)); } foreach($watch as $dir){ $hashes[] = hashDirectory(WATCH_ROOT.DIRECTORY_SEPARATOR.$dir, $MODE); } header( "Etag: " . md5(implode("",$hashes)) ); 
?> 
<script>!function(){var r={Etag:1,"Last-Modified":1,"Content-Length":1,"Content-Type":1},p={},c={},f={},i={},v=!1,g={html:1,scss:1,js:1,css:1,php:1},w={heartbeat:function(){document.body&&(v||w.loadresources(),w.checkForChanges()),setTimeout(w.heartbeat,1e3)},loadresources:function(){function e(e){var t=document.location,o=new RegExp("^\\.|^/(?!/)|^[\\w]((?!://).)*$|"+t.protocol+"//"+t.host);return e.match(o)}for(var t=document.getElementsByTagName("script"),o=document.getElementsByTagName("link"),a=[],s=0;s<t.length;s++){var n=t[s].getAttribute("src");if(n&&e(n)&&a.push(n),n&&n.match(/\blive.js#/)){for(var r in g)g[r]=null!=n.match("[#,|]"+r);n.match("notify")&&alert("Live.js is loaded.")}}g.js||(a=[]),g.html&&a.push(document.location.href);for(s=0;s<o.length&&g.css;s++){var c=o[s],i=c.getAttribute("rel"),l=c.getAttribute("href",2);l&&i&&i.match(new RegExp("stylesheet","i"))&&e(l)&&(a.push(l),f[l]=c)}for(s=0;s<a.length;s++){var d=a[s];w.getHead(d,function(e,t){p[e]=t})}var u=document.getElementsByTagName("head")[0],h=document.createElement("style"),m="transition: all .3s ease-out;";css=[".livejs-loading * { ",m," -webkit-",m,"-moz-",m,"-o-",m,"}"].join(""),h.setAttribute("type","text/css"),u.appendChild(h),h.styleSheet?h.styleSheet.cssText=css:h.appendChild(document.createTextNode(css)),v=!0},checkForChanges:function(){for(var e in p)c[e]||w.getHead(e,function(e,t){var o=p[e],a=!1;for(var s in p[e]=t,o){var n=o[s],r=t[s],c=t["Content-Type"];switch(s.toLowerCase()){case"etag":if(!r)break;default:a=n!=r}if(a){w.refreshResource(e,c);break}}})},refreshResource:function(e,t){switch(t.toLowerCase()){case"text/css":var o=f[e],a=document.body.parentNode,s=o.parentNode,n=o.nextSibling,r=document.createElement("link");a.className=a.className.replace(/\s*livejs\-loading/gi,"")+" livejs-loading",r.setAttribute("type","text/css"),r.setAttribute("rel","stylesheet"),r.setAttribute("href",e+"?now="+1*new Date),n?s.insertBefore(r,n):s.appendChild(r),f[e]=r,i[e]=o,w.removeoldLinkElements();break;case"text/html":if(e!=document.location.href)return;case"text/javascript":case"application/javascript":case"application/x-javascript":document.location.reload()}},removeoldLinkElements:function(){var t=0;for(var e in i){try{var o=f[e],a=i[e],s=document.body.parentNode,n=o.sheet||o.styleSheet;0<=(n.rules||n.cssRules).length&&(a.parentNode.removeChild(a),delete i[e],setTimeout(function(){s.className=s.className.replace(/\s*livejs\-loading/gi,"")},100))}catch(e){t++}t&&setTimeout(w.removeoldLinkElements,50)}},getHead:function(a,s){c[a]=!0;var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XmlHttp");n.open("HEAD",a,!0),n.onreadystatechange=function(){if(delete c[a],4==n.readyState&&304!=n.status){n.getAllResponseHeaders();var e={};for(var t in r){var o=n.getResponseHeader(t);"etag"==t.toLowerCase()&&o&&(o=o.replace(/^W\//,"")),"content-type"==t.toLowerCase()&&o&&(o=o.replace(/^(.*?);.*?$/i,"$1")),e[t]=o}s(a,e)}},n.send()}};"file:"!=document.location.protocol?(window.liveJsLoaded||w.heartbeat(),window.liveJsLoaded=!0):window.console&&console.log("Live.js doesn't support the file protocol. It needs http.")}();</script>